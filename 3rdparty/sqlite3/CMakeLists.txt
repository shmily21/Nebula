set(the_description "The SQLite3 Library")

aux_source_directory(src NEBULA_SQLITE3_SOURCE_CODE)

set(NEBULA_SQLITE3_LIBRARY sqlite3)

if(MSVC)
    add_definitions(-D_CRT_SECURE_NO_DEPRECATE)
endif(MSVC)

add_definitions(-DSQLITE_ENABLE_COLUMN_METADATA)
add_definitions(-DSQLITE_ENABLE_RTREE)

if(UNIX)
    if(CMAKE_COMPILER_IS_GUNCXX)
        set(CMAKE_C_FLAG "${CMAKE_C_FLAGS} -fPIC")
    endif(CMAKE_COMPILER_IS_GUNCXX)
elseif(WIN32)
    add_definitions(-D_WIN32)
endif(UNIX)

set(BUILD_TYPE_SQLITE3 "SHARED")

if(BUILD_STATIC_SQLITE3)
    set(BUILD_TYPE_SQLITE3  "STATIC")
endif(BUILD_STATIC_SQLITE3)

# 编译目标
add_library(${NEBULA_SQLITE3_LIBRARY} ${BUILD_TYPE_SQLITE3} ${NEBULA_SQLITE3_SOURCE_CODE})

nebula_warnings_disable(CMAKE_C_FLAGS -Wall -Wextra)

# 编译器标准
if(HAVE_COMPILER_STD_FLAG_GUN99_SUPPORT)
    set(CMAKE_C_FLAG "${CMAKE_C_FLAGS} ${NEBULA_COMPILER_STD_FLAG_GUN99}")
endif(HAVE_COMPILER_STD_FLAG_GUN99_SUPPORT)

# 目标属性
set_target_properties(${NEBULA_SQLITE3_LIBRARY} PROPERTIES DEFINE_SYMBOL NEBULA_SQLITE3_EXPORT)

set_target_properties(${NEBULA_SQLITE3_LIBRARY} PROPERTIES
        OUTPUT_NAME ${NEBULA_SQLITE3_LIBRARY}
        ARCHIVE_OUTPUT_DIRECTORY ${3P_LIBRARY_OUTPUT_PATH}
    )

if(ENABLE_SOLUTION_FOLDERS)
  set_target_properties(${NEBULA_SQLITE3_LIBRARY} PROPERTIES FOLDER "3rdparty")
endif()